<!-- BANNER SECTION -->
<app-banner-section
  title="HRA Tax"
  gradientText="Exemption Calculator"
  subtitle="Calculate your House Rent Allowance tax exemption under Section 10(13A)."
  badge="Income Tax Act - Section 10(13A)"
  badgeIcon="verified"
  [features]="bannerFeatures"
  [visualCards]="bannerVisualCards"
  illustration="/assets/images/HRA.jpeg">
</app-banner-section>

<!-- CALCULATOR SECTION -->
<section class="calculator-section">
  <div class="calculator-container">
    <!-- Calculator Card -->
    <div class="calculator-card">
      <div class="card-header">
        <div class="header-icon">
          <mat-icon aria-hidden="true">calculate</mat-icon>
        </div>
        <div class="header-content">
          <h2 class="card-title">Calculate Your HRA Exemption</h2>
          <p class="card-subtitle">
            Enter your salary details to calculate tax-exempt HRA
          </p>
        </div>
      </div>

      <form [formGroup]="hraForm" (ngSubmit)="calculateHRA()" class="calculator-form">
        <!-- Basic Salary -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Monthly Basic Salary</mat-label>
          <input matInput type="number" formControlName="basicSalary" placeholder="Enter monthly basic salary" />
          <span matPrefix>&nbsp;&nbsp;₹&nbsp;</span>
          <mat-icon matSuffix>account_balance_wallet</mat-icon>
          <mat-hint>Your basic salary per month</mat-hint>
          <mat-error *ngIf="hraForm.get('basicSalary')?.invalid">
            {{ getErrorMessage('basicSalary') }}
          </mat-error>
        </mat-form-field>

        <!-- Dearness Allowance -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Monthly Dearness Allowance (DA)</mat-label>
          <input matInput type="number" formControlName="dearnessAllowance"
            placeholder="Enter monthly DA (if applicable)" />
          <span matPrefix>&nbsp;&nbsp;₹&nbsp;</span>
          <mat-icon matSuffix>payments</mat-icon>
          <mat-hint>Leave as 0 if not applicable</mat-hint>
          <mat-error *ngIf="hraForm.get('dearnessAllowance')?.invalid">
            {{ getErrorMessage('dearnessAllowance') }}
          </mat-error>
        </mat-form-field>

        <!-- HRA Received -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Monthly HRA Received</mat-label>
          <input matInput type="number" formControlName="hraReceived" placeholder="Enter monthly HRA" />
          <span matPrefix>&nbsp;&nbsp;₹&nbsp;</span>
          <mat-icon matSuffix>home</mat-icon>
          <mat-hint>HRA component in your salary</mat-hint>
          <mat-error *ngIf="hraForm.get('hraReceived')?.invalid">
            {{ getErrorMessage('hraReceived') }}
          </mat-error>
        </mat-form-field>

        <!-- Rent Paid -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Monthly Rent Paid</mat-label>
          <input matInput type="number" formControlName="rentPaid" placeholder="Enter monthly rent" />
          <span matPrefix>&nbsp;&nbsp;₹&nbsp;</span>
          <mat-icon matSuffix>receipt</mat-icon>
          <mat-hint>Actual rent you pay per month</mat-hint>
          <mat-error *ngIf="hraForm.get('rentPaid')?.invalid">
            {{ getErrorMessage('rentPaid') }}
          </mat-error>
        </mat-form-field>

        <!-- City Type -->
        <div class="city-type-section">
          <label class="city-type-label">Select City Type</label>
          <mat-radio-group formControlName="cityType" class="city-type-group">
            <mat-radio-button *ngFor="let city of cityTypes" [value]="city.value" class="city-radio">
              <div class="city-option">
                <div class="city-name">{{ city.label }}</div>
                <div class="city-percentage">
                  {{ city.percentage }}% of Basic Salary
                </div>
              </div>
            </mat-radio-button>
          </mat-radio-group>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <button mat-raised-button color="primary" type="submit" class="calculate-button">
            <mat-icon aria-hidden="true">calculate</mat-icon>
            Calculate HRA Exemption
          </button>
          <button mat-button type="button" (click)="resetForm()" class="reset-button">
            <mat-icon aria-hidden="true">refresh</mat-icon>
            Reset
          </button>
        </div>
      </form>
    </div>

    <!-- Results Card -->
    <div class="results-card" *ngIf="showResult()" id="results-section">
      <div class="results-header">
        <div class="header-icon success">
          <mat-icon aria-hidden="true">check_circle</mat-icon>
        </div>
        <div class="header-content">
          <h2 class="results-title">Your HRA Calculation Results</h2>
          <p class="results-subtitle">
            Detailed breakdown of your HRA tax exemption
          </p>
        </div>
      </div>

      <div class="results-content" *ngIf="calculationResult()">
        <!-- Summary Cards -->
        <div class="summary-grid">
          <div class="summary-card primary">
            <div class="summary-icon">
              <mat-icon aria-hidden="true">home</mat-icon>
            </div>
            <div class="summary-content">
              <div class="summary-label">Total HRA Received</div>
              <div class="summary-value">
                {{ formatCurrency(calculationResult()!.actualHRA) }}
              </div>
              <div class="summary-period">Annually</div>
            </div>
          </div>

          <div class="summary-card success">
            <div class="summary-icon">
              <mat-icon aria-hidden="true">check_circle</mat-icon>
            </div>
            <div class="summary-content">
              <div class="summary-label">Exempt HRA</div>
              <div class="summary-value">
                {{ formatCurrency(calculationResult()!.exemptHRA) }}
              </div>
              <div class="summary-period">Tax Free</div>
            </div>
          </div>

          <div class="summary-card warning">
            <div class="summary-icon">
              <mat-icon aria-hidden="true">receipt_long</mat-icon>
            </div>
            <div class="summary-content">
              <div class="summary-label">Taxable HRA</div>
              <div class="summary-value">
                {{ formatCurrency(calculationResult()!.taxableHRA) }}
              </div>
              <div class="summary-period">Added to Income</div>
            </div>
          </div>

          <div class="summary-card accent">
            <div class="summary-icon">
              <mat-icon aria-hidden="true">savings</mat-icon>
            </div>
            <div class="summary-content">
              <div class="summary-label">Potential Tax Saved</div>
              <div class="summary-value">
                {{ formatCurrency(calculationResult()!.exemptHRA * 0.30) }}
              </div>
              <div class="summary-period">@30% Tax Rate</div>
            </div>
          </div>
        </div>

        <!-- Calculation Breakdown -->
        <div class="breakdown-section">
          <h3 class="breakdown-title">
            <mat-icon aria-hidden="true">analytics</mat-icon>
            Calculation Breakdown
          </h3>

          <div class="breakdown-info">
            <mat-icon class="info-icon">info</mat-icon>
            <p class="info-text">
              HRA exemption is calculated as the <strong>minimum</strong> of the
              following three amounts:
            </p>
          </div>

          <div class="breakdown-grid">
            <div class="breakdown-item">
              <div class="breakdown-number">1</div>
              <div class="breakdown-content">
                <h4 class="breakdown-label">Actual HRA Received</h4>
                <p class="breakdown-value">
                  {{ formatCurrency(calculationResult()!.actualHRA) }}
                </p>
                <p class="breakdown-desc">
                  Total HRA component in your annual salary
                </p>
              </div>
            </div>

            <div class="breakdown-item">
              <div class="breakdown-number">2</div>
              <div class="breakdown-content">
                <h4 class="breakdown-label">Rent Paid minus 10% of Basic</h4>
                <p class="breakdown-value">
                  {{ formatCurrency(calculationResult()!.excessRent) }}
                </p>
                <p class="breakdown-desc">
                  Rent: {{ formatCurrency(calculationResult()!.rentPaid) }} -
                  10% Basic: {{
                  formatCurrency(calculationResult()!.tenPercentBasic) }}
                </p>
              </div>
            </div>

            <div class="breakdown-item">
              <div class="breakdown-number">3</div>
              <div class="breakdown-content">
                <h4 class="breakdown-label">
                  {{ calculationResult()!.cityType === 'metro' ? '50%' : '40%'
                  }} of Basic Salary
                </h4>
                <p class="breakdown-value">
                  {{ formatCurrency(calculationResult()!.cityType === 'metro' ?
                  calculationResult()!.fiftyPercentBasic :
                  calculationResult()!.fortyPercentBasic) }}
                </p>
                <p class="breakdown-desc">
                  For {{ calculationResult()!.cityType === 'metro' ? 'Metro' :
                  'Non-Metro' }} cities
                </p>
              </div>
            </div>
          </div>

          <div class="final-result">
            <div class="result-box">
              <mat-icon class="result-icon">verified</mat-icon>
              <div class="result-content">
                <h4 class="result-label">
                  Final HRA Exemption (Minimum of above)
                </h4>
                <p class="result-value">
                  {{ formatCurrency(calculationResult()!.exemptHRA) }}
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="results-actions">
          <button mat-raised-button color="primary" (click)="downloadReport()" class="action-button">
            <mat-icon aria-hidden="true">download</mat-icon>
            Download Report
          </button>
          <button mat-button (click)="shareResults()" class="action-button-outline">
            <mat-icon aria-hidden="true">share</mat-icon>
            Share Results
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- EXAMPLES SECTION -->
<section class="examples-section">
  <div class="examples-container">
    <div class="section-header">
      <h2 class="section-title">HRA Calculation Examples</h2>
      <p class="section-subtitle">
        Understand how HRA exemption works with real-world scenarios
      </p>
    </div>

    <div class="examples-grid">
      <app-feature-card
        *ngFor="let example of hraExamples"
        [icon]="example.icon"
        [title]="example.title"
        [description]="example.description"
        [color]="example.color">
      </app-feature-card>
    </div>
  </div>
</section>

<!-- TAX TIPS SECTION -->
<section class="tips-section">
  <div class="tips-container">
    <div class="section-header">
      <h2 class="section-title">Important Tax Tips</h2>
      <p class="section-subtitle">
        Essential information to maximize your HRA benefits
      </p>
    </div>

    <div class="tips-grid">
      <app-feature-card
        *ngFor="let tip of taxTips"
        [icon]="tip.icon"
        [title]="tip.title"
        [description]="tip.description"
        color="accent">
      </app-feature-card>
    </div>
  </div>
</section>

<!-- FAQ SECTION -->
<section class="faq-section">
  <div class="faq-container">
    <div class="section-header">
      <h2 class="section-title">Frequently Asked Questions</h2>
      <p class="section-subtitle">
        Everything you need to know about HRA tax exemption
      </p>
    </div>

    <mat-accordion class="faq-accordion">
      <mat-expansion-panel *ngFor="let faq of faqs" class="faq-panel">
        <mat-expansion-panel-header>
          <mat-panel-title class="faq-question">
            <mat-icon class="faq-icon">{{ faq.icon }}</mat-icon>
            <span>{{ faq.question }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <p class="faq-answer">{{ faq.answer }}</p>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</section>

<!-- CTA SECTION -->
<section class="cta-section">
  <div class="cta-container">
    <div class="cta-content">
      <h2>Need Expert Tax Consultation?</h2>
      <p>
        Our certified tax consultants can help you optimize your tax planning
        and maximize savings
      </p>
      <button mat-raised-button color="primary" class="cta-button-large" routerLink="/contact">
        <mat-icon aria-hidden="true">support_agent</mat-icon>
        Talk to an Expert
      </button>
    </div>
  </div>
</section>

