<!-- BANNER SECTION -->
<div class="tax-slab-page">
  <app-banner-section
    title="Tax Regime"
    gradientText="Comparison"
    subtitle="Compare old and new tax slabs to optimize your tax planning."
    badge="Income Tax Calculator"
    badgeIcon="account_balance"
    [features]="bannerFeatures"
    [visualCards]="bannerVisualCards"
    illustration="assets/images/tax_slabs.jpg">
  </app-banner-section>

  <!-- Main Content Section -->
  <section class="content-section">
    <div class="content-container">
      <!-- Year Selector Card -->
      <div class="year-selector-card">
        <div class="selector-header">
          <div>
            <h3>üìÖ Select Financial Year</h3>
            <p>Choose the assessment year for tax slab comparison</p>
          </div>
        </div>

        <div class="year-chips">
          <button mat-button *ngFor="let year of years" [class.selected]="selectedYear === year"
            (click)="selectedYear = year; updateComparisonChart()" class="year-chip">
            <mat-icon aria-hidden="true">date_range</mat-icon>
            <span>{{ year }}</span>
          </button>
        </div>
      </div>

      <!-- Regime Comparison Cards -->
      <div class="regime-comparison">
        <!-- Old Regime Card -->
        <div class="regime-card old-regime">
          <div class="regime-header">
            <div>
              <h3 class="regime-title">üìã Old Tax Regime</h3>
              <p class="regime-subtitle">With Deductions & Exemptions</p>
            </div>
          </div>

          <div class="regime-features">
            <div class="feature-item">
              <span>‚úÖ 80C Deductions Available</span>
            </div>
            <div class="feature-item">
              <span>‚úÖ HRA & LTA Benefits</span>
            </div>
            <div class="feature-item">
              <span>‚úÖ Home Loan Interest</span>
            </div>
          </div>

          <div class="slab-table-wrapper">
            <table class="slab-table">
              <thead>
                <tr>
                  <th>
                    <div class="th-content">
                      <mat-icon aria-hidden="true">currency_rupee</mat-icon>
                      <span>Income Range</span>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                      <mat-icon aria-hidden="true">percent</mat-icon>
                      <span>Tax Rate</span>
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="
                    let slab of slabData[selectedYear]['old'];
                    let i = index
                  ">
                  <td class="range-cell">
                    <mat-icon aria-hidden="true">trending_flat</mat-icon>
                    <span>{{ slab.range }}</span>
                  </td>
                  <td class="rate-cell">
                    <span class="rate-badge" [class]="'rate-' + i">{{
                      slab.rate
                      }}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- New Regime Card -->
        <div class="regime-card new-regime">
          <div class="regime-header">
            <div>
              <h3 class="regime-title">‚ú® New Tax Regime</h3>
              <p class="regime-subtitle">Lower Rates, No Deductions</p>
            </div>
          </div>

          <div class="regime-features">
            <div class="feature-item">
              <span>‚úÖ Simplified Tax Structure</span>
            </div>
            <div class="feature-item">
              <span>‚úÖ Lower Tax Rates</span>
            </div>
            <div class="feature-item">
              <span>‚úÖ Default Regime (FY 24-25)</span>
            </div>
          </div>

          <div class="slab-table-wrapper">
            <table class="slab-table">
              <thead>
                <tr>
                  <th>
                    <div class="th-content">
                      <mat-icon aria-hidden="true">currency_rupee</mat-icon>
                      <span>‚Çπ Income Range</span>
                    </div>
                  </th>
                  <th>
                    <div class="th-content">
                      <mat-icon aria-hidden="true">percent</mat-icon>
                      <span>% Tax Rate</span>
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="
                    let slab of slabData[selectedYear]['new'];
                    let i = index
                  ">
                  <td class="range-cell">
                    <mat-icon aria-hidden="true">trending_flat</mat-icon>
                    <span>{{ slab.range }}</span>
                  </td>
                  <td class="rate-cell">
                    <span class="rate-badge" [class]="'rate-' + i">{{
                      slab.rate
                      }}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Detailed Comparison Table -->
      <div class="comparison-table-card">
        <div class="card-header">
          <div>
            <h3>üîç Detailed Rate Comparison</h3>
            <p>Side-by-side tax rate analysis for {{ selectedYear }}</p>
          </div>
        </div>

        <div class="comparison-table-wrapper">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>‚Çπ Income Range</th>
                <th class="old-regime-col">
                  <div class="col-header">
                    <span>üìã Old Regime</span>
                  </div>
                </th>
                <th class="new-regime-col">
                  <div class="col-header">
                    <span>‚ú® New Regime</span>
                  </div>
                </th>
                <th class="difference-col">
                  <div class="col-header">
                    <span>üîç Difference</span>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="
                  let row of comparisonData[selectedYear.replace('‚Äì', '-')]
                ">
                <td class="range-cell">{{ row.range }}</td>
                <td class="old-rate-cell">
                  <span class="rate-value">{{ row.oldRate }}</span>
                </td>
                <td class="new-rate-cell">
                  <span class="rate-value">{{ row.newRate }}</span>
                </td>
                <td class="difference-cell">
                  <span class="difference-badge" [class.lower]="
                      getRateDifference(row.oldRate, row.newRate) < 0
                    " [class.higher]="
                      getRateDifference(row.oldRate, row.newRate) > 0
                    " [class.same]="
                      getRateDifference(row.oldRate, row.newRate) === 0
                    ">
                    <mat-icon *ngIf="getRateDifference(row.oldRate, row.newRate) < 0">arrow_downward</mat-icon>
                    <mat-icon *ngIf="getRateDifference(row.oldRate, row.newRate) > 0">arrow_upward</mat-icon>
                    <mat-icon *ngIf="getRateDifference(row.oldRate, row.newRate) === 0">remove</mat-icon>
                    <span>{{
                      formatDifference(row.oldRate, row.newRate)
                      }}</span>
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Chart Card -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="header-left">
            <div>
              <h3>üìä Visual Comparison</h3>
              <p>Tax rate distribution across income slabs</p>
            </div>
          </div>
          <button mat-stroked-button color="primary" (click)="exportChart()" class="export-button">
            <span>üì• Export Chart</span>
          </button>
        </div>

        <div class="chart-wrapper">
          <canvas baseChart #comparisonChart [data]="comparisonChartData" [options]="comparisonChartOptions"
            [type]="comparisonChartType">
          </canvas>
        </div>

        <div class="chart-legend">
          <div class="legend-item old">
            <div class="legend-color"></div>
            <span>üìã Old Tax Regime</span>
          </div>
          <div class="legend-item new">
            <div class="legend-color"></div>
            <span>‚ú® New Tax Regime</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Info Section -->
  <section class="info-section">
    <div class="info-container">
      <h2 class="info-title">üîë Key Differences Between Regimes</h2>

      <div class="info-grid">
        <div class="info-card">
          <h3>üè¶ Deductions & Exemptions</h3>
          <p>
            Old regime allows various deductions under 80C, 80D, HRA, and LTA.
            New regime offers lower rates but no deductions.
          </p>
          <mat-chip-set>
            <mat-chip>80C - ‚Çπ1.5L</mat-chip>
            <mat-chip>HRA</mat-chip>
            <mat-chip>LTA</mat-chip>
          </mat-chip-set>
        </div>

        <div class="info-card">
          <h3>üöÄ Simplified Filing</h3>
          <p>
            New tax regime simplifies the tax filing process with fewer forms
            and calculations, saving time and reducing complexity.
          </p>
          <mat-chip-set>
            <mat-chip>Easy Filing</mat-chip>
            <mat-chip>Less Paperwork</mat-chip>
          </mat-chip-set>
        </div>

        <div class="info-card">
          <h3>üìâ Lower Tax Rates</h3>
          <p>
            New regime features reduced tax rates across multiple income slabs,
            especially beneficial for higher income groups.
          </p>
          <mat-chip-set>
            <mat-chip>Reduced Rates</mat-chip>
            <mat-chip>Higher Savings</mat-chip>
          </mat-chip-set>
        </div>

        <div class="info-card">
          <h3>üë• Who Benefits More?</h3>
          <p>
            Salaried individuals with fewer investments may benefit from new
            regime. Those with significant deductions should choose old regime.
          </p>
          <mat-chip-set>
            <mat-chip>Compare Both</mat-chip>
            <mat-chip>Choose Wisely</mat-chip>
          </mat-chip-set>
        </div>
      </div>
    </div>
  </section>

  <!-- Example Section -->
  <section class="example-section">
    <div class="example-container">
      <div class="section-header">
        <div class="header-badge">
          <mat-icon aria-hidden="true">calculate</mat-icon>
          <span>Real Example</span>
        </div>
        <h2 class="section-title">üíº Practical Tax Comparison</h2>
        <p class="section-subtitle">
          See how different income levels are taxed under both regimes for {{ selectedYear }}
        </p>
      </div>

      <div class="examples-grid">
        <mat-card class="example-card" *ngFor="let example of taxExamples[selectedYear.replace('‚Äì', '-')]">
          <div class="example-header">
            <div class="example-icon">
              <mat-icon aria-hidden="true">{{ example.icon }}</mat-icon>
            </div>
            <div>
              <h3>{{ example.title }}</h3>
              <p class="example-income">Annual Income: {{ example.income }}</p>
            </div>
          </div>
          
          <mat-divider></mat-divider>
          
          <div class="example-comparison">
            <div class="regime-result">
              <span class="regime-label">üí∞ Old Regime</span>
              <span class="tax-value">{{ example.oldTax }}</span>
            </div>
            <div class="regime-result">
              <span class="regime-label">üí∏ New Regime</span>
              <span class="tax-value better">{{ example.newTax }}</span>
            </div>
          </div>
          
          <div class="example-footer">
            <mat-icon class="check-icon">{{ example.savings > 0 ? 'check_circle' : 'info' }}</mat-icon>
            <span class="savings-text">{{ example.recommendation }}</span>
          </div>
        </mat-card>
      </div>
    </div>
  </section>

  <!-- Tips Section -->
  <section class="tips-section">
    <div class="tips-container">
      <div class="section-header">
        <div class="header-badge">
          <mat-icon aria-hidden="true">lightbulb</mat-icon>
          <span>Expert Advice</span>
        </div>
        <h2 class="section-title">üí° Smart Tax Planning Tips</h2>
        <p class="section-subtitle">
          Make informed decisions to optimize your tax liability
        </p>
      </div>

      <div class="tips-grid">
        <mat-card class="tip-card" *ngFor="let tip of taxPlanningTips">
          <div class="tip-icon-wrapper">
            <mat-icon class="tip-icon">{{ tip.icon }}</mat-icon>
          </div>
          <h3>{{ tip.title }}</h3>
          <p>{{ tip.description }}</p>
          <div class="tip-tags">
            <mat-chip *ngFor="let tag of tip.tags">{{ tag }}</mat-chip>
          </div>
        </mat-card>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="faq-section">
    <div class="faq-container">
      <div class="section-header">
        <div class="header-badge">
          <mat-icon aria-hidden="true">help_outline</mat-icon>
          <span>Got Questions?</span>
        </div>
        <h2 class="section-title">‚ùì Frequently Asked Questions</h2>
        <p class="section-subtitle">
          Everything you need to know about tax regimes in India
        </p>
      </div>

      <mat-accordion class="faq-accordion">
        <mat-expansion-panel *ngFor="let faq of faqs" class="faq-panel">
          <mat-expansion-panel-header>
            <mat-panel-title class="faq-question">
              <mat-icon class="faq-icon">{{ faq.icon }}</mat-icon>
              <span>{{ faq.question }}</span>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div class="faq-answer">
            <p>{{ faq.answer }}</p>
            <mat-chip-set *ngIf="faq.tags" class="faq-tags">
              <mat-chip *ngFor="let tag of faq.tags">{{ tag }}</mat-chip>
            </mat-chip-set>
          </div>
        </mat-expansion-panel>
      </mat-accordion>

      <div class="faq-footer">
        <p>
          üí¨ Still have questions? Our tax experts are here to guide you through your tax planning journey.
        </p>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <div class="cta-container">
      <h2>üßÆ Ready to Calculate Your Tax?</h2>
      <p>
        Use our advanced tax calculator to determine which regime saves you more
        money
      </p>
      <button mat-raised-button color="accent" class="cta-button" routerLink="/calculators/tax-calculator">
        <span>üéØ Calculate Now</span>
      </button>
    </div>
  </section>
</div>


